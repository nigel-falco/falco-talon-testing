customRules:
  custom-rules.yaml: |-
    - rule: Google Cloud IAM Service Accounts Modification via Container
      desc: >
        Detect attempts to use "gcloud iam service-accounts" command within containers
      condition: >
        evt.type=execve 
        and container
        and proc.cmdline contains "gcloud iam service-accounts"
      output: "gcloud iam service-accounts command executed within a container (command=%proc.cmdline user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname terminal=%proc.tty %container.info)"
      priority: NOTICE
      tags: [maturity_stable, container, gcloud, gcp, mitre_discovery, T1565]
